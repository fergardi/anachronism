<mat-sidenav-container class="app-sidenav-container" autosize>
  <mat-sidenav class="app-sidenav" #left mode="side" opened="true">
    <mat-toolbar>
      <button mat-icon-button (click)="left.toggle()">
        <mat-icon class="primary-color">keyboard_arrow_left</mat-icon>
      </button>
      <span class="flex-separator"></span>
      <h3 class="primary-color">FILTERS</h3>
      <span class="flex-separator"></span>
      <button mat-icon-button (click)="resetFilters()">
        <mat-icon class="primary-color">filter_list_off</mat-icon>
      </button>
    </mat-toolbar>
    <form [formGroup]="filters" class="sidenav-filters">
      <div class="filter-container">
        <label><b>Name</b></label>
        <mat-form-field appareance="outline">
          <input matInput placeholder="Name of the Card" formControlName="name"/>
        </mat-form-field>
      </div>
      <div class="filter-container">
        <label><b>Initiative</b></label>
        <mat-slider [min]="initiativeMin" [max]="initiativeMax" discrete>
          <input value="0" matSliderStartThumb formControlName="initiativeMin">
          <input value="0" matSliderEndThumb formControlName="initiativeMax">
        </mat-slider>
      </div>
      <div class="filter-container input-centered">
        <label><b>Attack</b></label>
        <div fxLayout="row" fxLayoutAlign="center center">
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_1_1"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_1_2"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_1_3"/>
            </mat-form-field>
          </div>
        </div>
        <div fxLayout="row" fxLayoutAlign="center center">
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_2_1"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_2_2"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_2_3"/>
            </mat-form-field>
          </div>
        </div>
        <div fxLayout="row" fxLayoutAlign="center center">
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_3_1"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="X/+0" formControlName="grid_3_2"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_3_3"/>
            </mat-form-field>
          </div>
        </div>
        <div fxLayout="row" fxLayoutAlign="center center">
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_4_1"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0/X" formControlName="grid_4_2"/>
            </mat-form-field>
          </div>
          <div fxFlex="33">
            <mat-form-field appareance="outline">
              <input matInput placeholder="+0" formControlName="grid_4_3"/>
            </mat-form-field>
          </div>
        </div>
      </div>
      <div class="filter-container">
        <label><b>Culture</b>&nbsp;&nbsp;<span class="middot">·</span>&nbsp;&nbsp;<span class="disabled-color">Type</span>&nbsp;&nbsp;<span class="middot">·</span>&nbsp;&nbsp;<span class="disabled-color">Subtype</span></label>
        <mat-chip-listbox multiple formControlName="cultures">
          <mat-chip-option *ngFor="let c of cultures">{{ c }}</mat-chip-option>
        </mat-chip-listbox>
      </div>
      <div class="filter-container">
        <label><span class="disabled-color">Culture</span>&nbsp;&nbsp;<span class="middot">·</span>&nbsp;&nbsp;<b>Type</b>&nbsp;&nbsp;<span class="middot">·</span>&nbsp;&nbsp;<span class="disabled-color">Subtype</span></label>
        <mat-chip-listbox multiple formControlName="types">
          <mat-chip-option *ngFor="let t of types">{{ t }}</mat-chip-option>
        </mat-chip-listbox>
      </div>
      <div class="filter-container">
        <label><span class="disabled-color">Culture</span>&nbsp;&nbsp;<span class="middot">·</span>&nbsp;&nbsp;<span class="disabled-color">Type</span>&nbsp;&nbsp;<span class="middot">·</span>&nbsp;&nbsp;<b>Subtype</b></label>
        <mat-chip-listbox multiple formControlName="subtypes">
          <mat-chip-option *ngFor="let s of subtypes">{{ s }}</mat-chip-option>
        </mat-chip-listbox>
      </div>
      <div class="filter-container">
        <label><b>Hands</b></label>
        <mat-slider min="0" max="2" discrete>
          <input value="0" matSliderStartThumb formControlName="handsMin">
          <input value="2" matSliderEndThumb formControlName="handsMax">
        </mat-slider>
      </div>
      <div class="filter-container">
        <label><b>Element</b></label>
        <mat-chip-listbox multiple formControlName="elements">
          <mat-chip-option *ngFor="let e of elements">{{ e }}</mat-chip-option>
        </mat-chip-listbox>
      </div>
      <div class="filter-container">
        <label><b>Text</b></label>
        <mat-form-field appareance="outline">
          <textarea matInput placeholder="Ability, Reveal, Action or Text" formControlName="text"></textarea>
        </mat-form-field>
      </div>
      <div class="filter-container">
        <label><b>Life</b></label>
        <mat-slider [min]="lifeMin" [max]="lifeMax" discrete>
          <input value="0" matSliderStartThumb formControlName="lifeMin">
          <input value="0" matSliderEndThumb formControlName="lifeMax">
        </mat-slider>
      </div>
      <div class="filter-container">
        <label><b>Speed</b></label>
        <mat-slider [min]="speedMin" [max]="speedMax" discrete>
          <input value="0" matSliderStartThumb formControlName="speedMin">
          <input value="0" matSliderEndThumb formControlName="speedMax">
        </mat-slider>
      </div>
      <div class="filter-container">
        <label><b>Experience</b></label>
        <mat-slider [min]="experienceMin" [max]="experienceMax" discrete>
          <input value="0" matSliderStartThumb formControlName="experienceMin">
          <input value="0" matSliderEndThumb formControlName="experienceMax">
        </mat-slider>
      </div>
      <div class="filter-container">
        <label><b>Damage</b></label>
        <mat-slider [min]="damageMin" [max]="damageMax" discrete>
          <input value="0" matSliderStartThumb formControlName="damageMin">
          <input value="0" matSliderEndThumb formControlName="damageMax">
        </mat-slider>
      </div>
      <div class="filter-container">
        <label><b>Perks</b></label>
        <mat-checkbox color="primary" formControlName="isMultipleWeapon">Multiple Weapons</mat-checkbox>
        <mat-checkbox color="primary" formControlName="isMultipleArmor">Multiple Armors</mat-checkbox>
        <mat-checkbox color="primary" formControlName="isMultipleInspiration">Multiple Inspirations</mat-checkbox>
        <mat-checkbox color="primary" formControlName="isMultipleSpecial">Multiple Specials</mat-checkbox>
        <mat-checkbox color="primary" formControlName="isReveal">Has Reveal</mat-checkbox>
        <mat-checkbox color="primary" formControlName="isAction">Has Action</mat-checkbox>
        <mat-checkbox color="primary" formControlName="isRivalry">Has Rivalry</mat-checkbox>
        <mat-checkbox color="primary" formControlName="isDiscard">Has Discard</mat-checkbox>
      </div>
      <div class="filter-container">
        <label><b>Set</b></label>
        <mat-chip-listbox multiple formControlName="sets">
          <mat-chip-option *ngFor="let s of sets">{{ s }}</mat-chip-option>
        </mat-chip-listbox>
      </div>
      <!--<div>{{ filters.value | json }}</div>-->
    </form>
  </mat-sidenav>
  <mat-sidenav-content class="app-sidenav-content">
    <mat-toolbar class="app-sidenav-toolbar" fxLayout="row" fxLayoutAlign="space-between center">
      <div fxFlex="20" fxLayout="row" fxLayoutAlign="start center">
        <button mat-icon-button (click)="left.toggle()">
          <mat-icon class="primary-color">filter_list</mat-icon>
        </button>
        <span class="primary-color"><div matBadge="{{ filteredCards().length }}/{{ cards.length }}" matBadgeOverlap="false">CARDS</div></span>
      </div>
      <div fxFlex="40">
        <div class="search-container">
          <form [formGroup]="search" class="input-centered">
            <mat-form-field appareance="outline">
              <mat-icon matPrefix class="primary-color">search</mat-icon>
              <input matInput placeholder="Quick Search" formControlName="query"/>
              <button matSuffix mat-icon-button (click)="resetSearch()">
                <mat-icon class="primary-color">close</mat-icon>
              </button>
            </mat-form-field>
          </form>
        </div>
      </div>
      <div fxFlex="20" fxLayout="row" fxLayoutAlign="end center">
        <h3 class="primary-color"><div matBadge="{{notEmptyCards()}}/{{deck.length}}" matBadgePosition="before" matBadgeOverlap="false">DECK</div></h3>
        <button mat-icon-button (click)="right.toggle()">
          <mat-icon class="primary-color">style</mat-icon>
        </button>
      </div>
    </mat-toolbar>
    <main class="app-main">
      <div class="flexbox-container" fxLayout="row wrap" fxLayoutAlign="start start">
        <div class="flexbox-item" fxFlex.xl="12.5" fxFlex.lg="20" fxFlex.md="33" fxFlex.sm="50" fxFlex.xs="50" *ngFor="let card of filteredCards()">
          <mat-card class="anachronism-card" (click)="addToDeck(card)">
            <img mat-card-image [src]="'assets/cards/' + card.set + '_' + card.number + '.jpg'" [alt]="card.name">
          </mat-card>
        </div>
      </div>
    </main>
  </mat-sidenav-content>
  <mat-sidenav class="app-sidenav" #right mode="side" opened="true" position="end">
    <mat-toolbar>
      <button mat-icon-button (click)="resetDeck()">
        <mat-icon class="primary-color">delete</mat-icon>
      </button>
      <span class="flex-separator"></span>
      <h3 class="primary-color">
        <button mat-stroked-button class="info-button" color="primary" (click)="openRules($event)">
          <div matBadge="priority_high" matBadgeOverlap="false" matBadgeColor="warn" [matBadgeHidden]="isDeckValid()" class="invalid-deck">RULES</div>
        </button>
      </h3>
      <span class="flex-separator"></span>
      <button mat-icon-button (click)="right.toggle()">
        <mat-icon class="primary-color">keyboard_arrow_right</mat-icon>
      </button>
    </mat-toolbar>
    <div class="sidenav-deck" cdkDropList (cdkDropListDropped)="drop($event)">
      <mat-card class="anachronism-card" *ngFor="let card of deck; let i = index" [style.--index]="i" [class]="isCardValid(card) ? '' : 'invalid-card'" cdkDrag (click)="removeFromDeck(i)">
        <img mat-card-image [src]="'assets/cards/' + card.set + '_' + card.number + '.jpg'" [alt]="card.name">
      </mat-card>
    </div>
  </mat-sidenav>
</mat-sidenav-container>
